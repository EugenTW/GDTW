'use strict';const REPORT_TYPE_MAP={url:1,album:2,image:3},REPORT_REASON_MAP={child:1,violence:2,hate:3,other:4};let _captchaVal="";function generateCaptcha(){return Math.floor(100+Math.random()*900).toString()+Math.floor(100+Math.random()*900).toString()}function setCaptcha(){_captchaVal=generateCaptcha();document.getElementById("captcha-value").textContent=_captchaVal.slice(0,3)+" "+_captchaVal.slice(3)}
function showAlert(b,c=!0){let a=document.createElement("div");a.style.position="fixed";a.style.left="50%";a.style.top="50%";a.style.transform="translate(-50%, -50%)";a.style.background=c?"#185a36":"#a1002b";a.style.color="#fff";a.style.padding="15px 15px";a.style.borderRadius="10px";a.style.fontSize="16px";a.style.fontWeight="bold";a.style.zIndex=9999;a.style.textAlign="center";a.innerHTML=b;document.body.appendChild(a);setTimeout(()=>{document.body.removeChild(a)},2E3)}
function isValidCaptcha(b){return b===_captchaVal}function resetForm(){document.getElementById("report-type").selectedIndex=0;document.getElementById("report-reason").selectedIndex=0;document.getElementById("captcha-input").value="";document.getElementById("captcha-input").placeholder="\u8acb\u8f38\u5165\u4e0a\u65b9\u516d\u4f4d\u6578\u5b57 / Enter the 6-digit number above";setCaptcha();document.querySelector(".report-submit").disabled=!0}
function checkFormReady(){const b=document.getElementById("report-type").value,c=document.getElementById("report-reason").value,a=document.getElementById("captcha-input").value,d=document.querySelector(".report-submit");b&&c&&a.length===6&&isValidCaptcha(a)?d.disabled=!1:d.disabled=!0}
document.addEventListener("DOMContentLoaded",function(){setCaptcha();document.getElementById("refresh-captcha").onclick=function(b){b.preventDefault();setCaptcha();document.getElementById("captcha-input").value="";document.getElementById("captcha-input").placeholder="\u8acb\u8f38\u5165\u4e0a\u65b9\u516d\u4f4d\u6578\u5b57 / Enter the 6-digit number above";checkFormReady()};document.getElementById("report-type").onchange=checkFormReady;document.getElementById("report-reason").onchange=checkFormReady;
    document.getElementById("captcha-input").addEventListener("input",function(){this.value.length>6&&(this.value=this.value.slice(0,6));checkFormReady()});document.getElementById("captcha-input").addEventListener("blur",function(){this.value&&!isValidCaptcha(this.value)&&(this.value="",this.placeholder="\u8acb\u91cd\u65b0\u8f38\u5165 / Please enter again",checkFormReady())});document.querySelector(".report-form").onsubmit=async function(b){b.preventDefault();b=document.querySelector(".report-submit");
        b.disabled=!0;var c=document.getElementById("report-type").value;const a=document.getElementById("report-reason").value;c={reportType:REPORT_TYPE_MAP[c]||0,reportReason:REPORT_REASON_MAP[a]||0};try{const d=await (await fetch("/rv_api/send_report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();d.reportStatus===!0?(showAlert("\u8209\u5831\u9001\u51fa\u6210\u529f\u8b1d\u8b1d\u60a8\x3cbr\x3eReport sent successfully, thank you!"),resetForm()):(showAlert("\u932f\u8aa4 / Error: \x3cbr\x3e"+
            d.response,!1),b.disabled=!1)}catch(d){showAlert("\u932f\u8aa4 / Error:\x3cbr\x3e \u7db2\u8def\u932f\u8aa4\u6216\u7121\u6cd5\u9001\u51fa / Network error or unable to send",!1),b.disabled=!1}}});